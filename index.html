<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Materi Belajar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px
      background: blue;
    }
    .container {
      margin-bottom: 20px;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: 1px solid darkblue;
    }
    #btnSelesai {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background: gray;
      color: white;
      cursor: not-allowed;
      border-radius: 6px;
    }
    #btnSelesai.active {
      background: darkblue;
      cursor: pointer;
    }
    .status {
      margin: 10px 0;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>ðŸ“– Materi Bacaan</h2>
  
  <!-- Bacaan PDF 1 -->
  <div class="container">
    <h3>Bacaan 1 (Mohon untuk dibaca ulang materi kemarin)scroll sampai habis membaca</h3>
    <iframe id="pdf1" src="https://drive.google.com/file/d/1bg6p1kqUIQkAYH0HjvGAbE11RQDRoHfZ/preview"></iframe>
    <div id="statusPdf1" class="status">Status: Belum selesai</div>
  </div>

  <!-- Bacaan PDF 2 -->
  <div class="container">
    <h3>Bacaan 2</h3>
    <iframe id="pdf2" src="https://drive.google.com/file/d/1gNpOnwAQHWJuUN-MMr_aZ6EwUpR0U3Ol/preview"></iframe>
    <div id="statusPdf2" class="status">Status: Belum selesai</div>
  </div>

  <!-- Video YouTube -->
  <div class="container">
    <h3>ðŸŽ¬ Materi Video</h3>
    <h3>Tonton Video Sampai Waktu Habis, tidak bisa dipercepat.setelah waktu habis maka tombol selesai akan menyala, kemudian klik selesai untuk mengerjakan tugas</h3>
    <div id="materiVideo"></div>
    <div id="videoTimer" class="status">Status: Belum selesai</div>
  </div>

  <!-- Tombol selesai -->
  <button id="btnSelesai" disabled>Selesai</button>

  <script>
    let pdf1Done = false;
    let pdf2Done = false;
    let videoDone = false;
    let videoDuration = 0;
    let player;
    let lastTime = 0;

    let btnSelesai = document.getElementById("btnSelesai");
    let statusPdf1 = document.getElementById("statusPdf1");
    let statusPdf2 = document.getElementById("statusPdf2");
    let videoTimerDisplay = document.getElementById("videoTimer");

    // Fungsi cek selesai
    function cekSelesai() {
      if (pdf1Done && pdf2Done && videoDone) {
        btnSelesai.disabled = false;
        btnSelesai.classList.add("active");
        btnSelesai.textContent = "Klik untuk Selesai";
      }
    }

    // Simulasi scroll PDF (iframe drive tidak bisa dideteksi scroll langsung)
    // Jadi kita pakai timer sebagai simulasi "membaca minimal durasi"
    setTimeout(() => {
      pdf1Done = true;
      statusPdf1.textContent = "Status: Bacaan 1 selesai âœ…";
      cekSelesai();
    }, 10000); // 10 detik simulasi baca PDF 1

    setTimeout(() => {
      pdf2Done = true;
      statusPdf2.textContent = "Status: Bacaan 2 selesai âœ…";
      cekSelesai();
    }, 15000); // 15 detik simulasi baca PDF 2

    // Load YouTube API
    let tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.body.appendChild(tag);

    // YouTube API siap
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('materiVideo', {
        height: '360',
        width: '640',
        videoId: 'oeMbwRc0ccI', // Ganti dengan ID video
        events: {
          'onReady': function(event) {
            videoDuration = Math.floor(player.getDuration());
          },
          'onStateChange': function(event) {
            if (event.data == YT.PlayerState.PLAYING) {
              let timer = setInterval(() => {
                let currentTime = Math.floor(player.getCurrentTime());

                // deteksi skip
                if (currentTime - lastTime > 2) {
                  player.seekTo(lastTime);
                } else {
                  lastTime = currentTime;
                }

                // tampilkan sisa waktu
                let remaining = videoDuration - currentTime;
                let minutes = Math.floor(remaining / 60);
                let seconds = remaining % 60;
                videoTimerDisplay.textContent = `Sisa Durasi: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (currentTime >= videoDuration - 1) {
                  videoDone = true;
                  videoTimerDisplay.textContent = "Video selesai âœ…";
                  cekSelesai();
                  clearInterval(timer);
                }
              }, 1000);
            }
          }
        }
      });
    }

    // Redirect setelah selesai
    btnSelesai.addEventListener("click", function() {
      window.location.href = "https://www.educaplay.com/learning-resources/25387731-game_cabang_iman_bab_2.html"; // ganti dengan link tugas (Google Form atau lainnya)
    });
  </script>
</body>
</html>
